<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="REDCapDM">
<title>REDCapDM • REDCapDM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="REDCapDM">
<meta property="og:description" content="REDCapDM">
<meta property="og:image" content="https://brui.github.io/REDCapDM/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">REDCapDM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/REDCapDM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Data-reading-and-processing.html">REDCapDM - Data reading and processing</a>
    <a class="dropdown-item" href="../articles/Queries.html">REDCapDM - Queries</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bruigtp/REDCapDM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="REDCapDM_files/kePrint-0.0.1/kePrint.js"></script><link href="REDCapDM_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>REDCapDM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bruigtp/REDCapDM/blob/HEAD/vignettes/REDCapDM.Rmd" class="external-link"><code>vignettes/REDCapDM.Rmd</code></a></small>
      <div class="d-none name"><code>REDCapDM.Rmd</code></div>
    </div>

    
    
<p><br><br></p>
<div class="section level2">
<h2 id="introduction">
<strong>Introduction</strong><a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The REDCapDM package allows users to read data exported directly from
REDCap or via API connection. It also allows users to process the
previously downloaded data, create reports of queries such as outliers
or missing values and track the identified queries.</p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="functions">
<strong>Functions</strong><a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>Functions included in the package:</p>
<ul>
<li><p><code><a href="../reference/redcap_data.html">redcap_data()</a></code>: reads data.</p></li>
<li><p><code><a href="../reference/rd_transform.html">rd_transform()</a></code>: processes data.</p></li>
<li><p><code><a href="../reference/rd_rlogic.html">rd_rlogic()</a></code>: transforms REDCap logic into R
logic.</p></li>
<li><p><code><a href="../reference/rd_insert_na.html">rd_insert_na()</a></code>: allows a manual entry of a missing
value in specific variables using a filter.</p></li>
<li><p><code><a href="../reference/rd_query.html">rd_query()</a></code>: identifies queries.</p></li>
<li><p><code><a href="../reference/rd_event.html">rd_event()</a></code>: identifies missing events.</p></li>
<li><p><code><a href="../reference/check_queries.html">check_queries()</a></code>: tracks queries.</p></li>
</ul>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="built-in-dataset">
<strong>Built-in dataset</strong><a class="anchor" aria-label="anchor" href="#built-in-dataset"></a>
</h2>
<p>For the following examples, we will use a random sample of the
COVICAN study which is included in the package. COVICAN is an
international, multicentre cohort study of cancer patients with COVID-19
to describe the epidemiology, risk factors, and clinical outcomes of
co-infections and superinfections in onco-hematological patients with
COVID-19.</p>
<p>We can load the built-in dataset by typing:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">covican</span><span class="op">)</span></span></code></pre></div>
<p>The structure of this dataset is:</p>
<pre><code>List of 3
 $ data      :'data.frame': 342 obs. of  56 variables:
 $ dictionary:'data.frame': 21 obs. of  18 variables:
 $ event_form:'data.frame': 9 obs. of  3 variables:</code></pre>
<p>The first element in the list is a data frame containing all the
data. The second element is a data frame with the information in the
dictionary of the project about each field. The third and final element
is a data frame containing the correspondence of each event with each
form.</p>
<p>Some of the variables in the dataset are:</p>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;">
Name
</th>
<th style="text-align:left;font-weight: bold;">
Description
</th>
<th style="text-align:left;font-weight: bold;">
Categories
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
record_id
</td>
<td style="text-align:left;">
Identifier of each record
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
redcap_event_name
</td>
<td style="text-align:left;">
Auto-generated name of the events
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
redcap_data_access_group
</td>
<td style="text-align:left;">
Auto-generated name of each center
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
inc_1
</td>
<td style="text-align:left;">
Patients older than 18 years
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
inc_2
</td>
<td style="text-align:left;">
Cancer patients
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
inc_3
</td>
<td style="text-align:left;">
Diagnosed of COVID-19
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
exc_1
</td>
<td style="text-align:left;">
Solid tumour remission &gt;1 year
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
screening_fail_crit
</td>
<td style="text-align:left;">
Indicator of non-compliance with inclusion and exclusion criteria
</td>
<td style="text-align:left;">
Compliance ; Non-compliance
</td>
</tr>
<tr>
<td style="text-align:left;">
d_birth
</td>
<td style="text-align:left;">
Date of birth (y-m-d)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
d_admission
</td>
<td style="text-align:left;">
Date of first visit (y-m-d)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
Age
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
dm
</td>
<td style="text-align:left;">
Indicator of diabetes
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
type_dm
</td>
<td style="text-align:left;">
Type of diabetes
</td>
<td style="text-align:left;">
No complications ; End-organ diabetes-related disease
</td>
</tr>
<tr>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
Indicator of chronic pulmonary disease
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
fio2
</td>
<td style="text-align:left;">
Fraction of inspired oxygen (%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
available_analytics
</td>
<td style="text-align:left;">
Indicator of blood test available
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
potassium
</td>
<td style="text-align:left;">
Potassium (mmol/L)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
resp_rate
</td>
<td style="text-align:left;">
Respiratory rate (bpm)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
leuk_lymph
</td>
<td style="text-align:left;">
Indicator of leukemia or lymphoma
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
<tr>
<td style="text-align:left;">
acute_leuk
</td>
<td style="text-align:left;">
Indicator of acute leukemia
</td>
<td style="text-align:left;">
No ; Yes
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div class="section level2">
<h2 id="examples">
<strong>Examples</strong><a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The package structure can be divided into three main components:
reading raw data, processing data and identifying queries. Typically,
after collecting data in REDCap, we will have to follow this three
components in order to have a final validated dataset for analysis. We
will provide a complete user guide on how to perform each one of these
steps using the package’s functions. For the processing of the data and
query identification, we will use the built-in dataset as an
example.</p>
<div class="section level3">
<h3 id="read-data">
<strong>Read data</strong><a class="anchor" aria-label="anchor" href="#read-data"></a>
</h3>
<div class="section level4">
<h4 id="redcap_data">
<strong>redcap_data</strong><a class="anchor" aria-label="anchor" href="#redcap_data"></a>
</h4>
<p>The <code><a href="../reference/redcap_data.html">redcap_data()</a></code> function allows users to easily import
data from a REDCap project into R for analysis.</p>
<p>To read exported data from REDCap, use the arguments
<code>data_path</code> and <code>dic_path</code> to, respectively,
describe the path of the R file and the REDCap project’s dictionary:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_data.html">redcap_data</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"C:/Users/username/example.r"</span>,</span>
<span>                       dic_path <span class="op">=</span> <span class="st">"C:/Users/username/example_dictionary.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Note: The R and CSV files exported from REDCap must be located in the
same directory.</p>
<p>If the REDCap project is longitudinal (contains more than one event)
then a third element should be specified with the correspondence of each
event with each form of the project. This csv file can be downloaded in
the REDCap of the project following these steps: <em>Project Setup</em>
&lt; <em>Designate Instruments for My Events</em> &lt; <em>Download
instrument-event mappings (CSV)</em>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_data.html">redcap_data</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"C:/Users/username/example.r"</span>,</span>
<span>                       dic_path <span class="op">=</span> <span class="st">"C:/Users/username/example_dictionary.csv"</span>,</span>
<span>                       event_path <span class="op">=</span> <span class="st">"C:/Users/username/events.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Note: if the project is longitudinal and the event-form file is not
provided using the <code>event_path</code> argument, some steps of the
processment can not be performed.</p>
<p>Another way to read data exported from a REDCap project is using an
API connection. To do this, we can use the arguments <code>uri</code>
and <code>token</code> which respectively refer to the uniform resource
identifier of the REDCap project and the user-specific string that
serves as the password:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset_api</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/redcap_data.html">redcap_data</a></span><span class="op">(</span>uri <span class="op">=</span> <span class="st">"https://redcap.idibell.cat/api/"</span>,</span>
<span>                           token <span class="op">=</span> <span class="st">"55E5C3D1E83213ADA2182A4BFDEA"</span><span class="op">)</span></span></code></pre></div>
<p>In this case, there is no need to specify the event-form file since
the function will download it automatically using the API connection, if
the project is longitudinal.</p>
<p><strong>Warning</strong>: Please keep in mind that the API token
gives you special access to the REDCap project and that it should not be
shared with other people.</p>
<p>This function returns a list with 3 elements (imported data,
dictionary and event-form mapping) which can then be used for further
analysis or visualization.</p>
</div>
</div>
<div class="section level3">
<h3 id="process">
<strong>Process</strong><a class="anchor" aria-label="anchor" href="#process"></a>
</h3>
<div class="section level4">
<h4 id="rd_transform">
<strong>rd_transform</strong><a class="anchor" aria-label="anchor" href="#rd_transform"></a>
</h4>
<p>The main function involved in the processing of the data is
<code><a href="../reference/rd_transform.html">rd_transform()</a></code>. This function is used to process the REDCap
data read into R using the <code><a href="../reference/redcap_data.html">redcap_data()</a></code>, as described
above. Using the arguments of the function we can perform different type
of transformations of our data.</p>
<p>As previously stated, we will use the built-in dataset
<code><a href="../reference/covican.html">REDCapDM::covican</a></code> as an example.</p>
<div class="section level5">
<h5 id="data-transformation">
<em>Data transformation</em><a class="anchor" aria-label="anchor" href="#data-transformation"></a>
</h5>
<p>The only necessary elements that must be provided are the dataset to
be transformed and the corresponding dictionary. If the project is
longitudinal, as in the case of <code><a href="../reference/covican.html">REDCapDM::covican</a></code>, also the
event-form dataset should be specified. These elements can be specified
directly using the output of the <code><a href="../reference/redcap_data.html">redcap_data()</a></code> function or
separately in different arguments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Option A: list object </span></span>
<span><span class="va">covican_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Option B: separately with different arguments</span></span>
<span><span class="va">covican_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">covican</span><span class="op">$</span><span class="va">data</span>, </span>
<span>                                    dic <span class="op">=</span> <span class="va">covican</span><span class="op">$</span><span class="va">dictionary</span>, </span>
<span>                                    event_form <span class="op">=</span> <span class="va">covican</span><span class="op">$</span><span class="va">event_form</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Print the results of the transformation</span></span>
<span><span class="va">covican_transformed</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<pre><code>1. Removing selected variables

2. Deleting variables that contain some patterns

3. Recalculating calculated fields and saving them as '[field_name]_recalc'
| Total calculated fields | Non-transcribed fields | Recalculated different fields |
|:-----------------------:|:----------------------:|:-----------------------------:|
|            2            |         0 (0%)         |            1 (50%)            |


|     field_name      | Transcribed? | Is equal? |
|:-------------------:|:------------:|:---------:|
|         age         |     Yes      |   FALSE   |
| screening_fail_crit |     Yes      |   TRUE    |

4. Transforming checkboxes: changing their values to No/Yes and changing their names to the names of its options. For checkboxes that have a branching logic, when the logic is missing their values will be set to missing

Table: Checkbox variables advisable to be reviewed

| Variables without any branching logic |
|:-------------------------------------:|
|        type_underlying_disease        |

5. Replacing original variables for their factor version

6. Converting every branching logic in the dictionary into R logic</code></pre>
<p>This function will return a list with the transformed dataset,
dictionary, event_form and the output of the results of the
transformation.</p>
<p>As we can see, there are several steps in the transformation:</p>
<ol>
<li>
<u>Elimination of variables:</u> we can specify any variable in the
dataset which we want to remove using the argument
<code>delete_vars</code>, as explained later.
</li>
<li>
<u>Elimination of variables containing some pattern:</u> by default, the
pattern that the function looks for is ’_complete’ and ’_timestamp’. We
can specify any other pattern using the argument
<code>delete_pattern</code>, as explained later.
</li>
<p>In this case, we do not have any variable with the pattern
’_complete’ and ’_timestamp’ since the built-in dataset only contains a
sample of the variables of the project. All REDCap projects, when
downloaded, contain one variable with the pattern ’_complete’ for each
form indicating if the form has been marked as
incomplete/unverified/completed. Also, if the project contains some
survey then variables ending with ’_timestamp’ are also generated
automatically. In general, we do not need this information so these
variables are removed by default.</p>
<li>
<u>Recalculation of REDCap calculated fields:</u> it finds all the
calculated fields and recalculates them using the REDCap logic specified
in the calculation field translated into R. The recalculated variable is
saved as the original name adding ’_recalc’ at the end. It can happen
that the logic found contains some specific smart-variables or other
complex structures which the function is not able to transcribe. With
the summary found in <code>results</code> we can see how many calculated
fields have been found, if they have been transcribed and, if that is
the case, if the recalculated variable is equal to the original one.
</li>
<p>Note: If the REDCap project is longitudinal and the event-form is not
specified, this step will not be executed.</p>
<p>In the example, we can see how there are two REDCap calculated
fields, both have been transcribed successfully and the recalculation of
the age does not match the original calculated variable from REDCap.</p>
<li>
<u>Checkbox transformation:</u> by default, it changes the names of the
checkboxes to the name of its corresponding option and the name of their
labels to ‘No/Yes’. If we want to specify another pair of label names we
can specify them using the <code>checkbox_labels</code> argument as we
will see. Furthermore, if the checkbox contains a branching logic, when
this logic evaluated returns a missing value (some of the variables
specified in it are missing) the values of the checkbox will be set to
missing.
</li>
<p>Note: If the REDCap project is longitudinal and the event-form is not
specified, the evaluations of the branching logic will not be done.</p>
<p>For example, let’s explain the transformation that undergo the
variables corresponding to the checkbox field of the type of underlying
disease. The variables were named originally as
_type_underlying_disease__<em>0</em> and
_type_underlying_disease__<em>1</em> although the name of the options
are ‘Haematological cancer’ and ‘Solid tumour’. Thus, in the transformed
dataset, the names are converted to
<em>type_underlying_disease_haematological_cancer</em> and
<em>type_underlying_disease_solid_tumour</em>. Then, since this checkbox
variable does not have a branching logic, the variable is advised to be
reviewed by the user in the <code>results</code>, as seen above. When
reviewed we could use an additional function <code><a href="../reference/rd_insert_na.html">rd_insert_na()</a></code>
to insert the necessary missing values into this variable, as we will
explain later. If a branching logic was found for this variable,
<code>rd_transform</code> will insert automatically the missing values
when the logic is not satisfied and no further transformation will be
needed.</p>
<li>
<u>Replacement of the original variable by its factor version:</u>
REDCap creates two versions of the variables in the dataset for
multiple-choice fields: a numerical one with the number that corresponds
to each category and a factor one containing the labels of each
category. In this step, we will replace the original variables with
their factor versions, except for <em>redcap_event_name</em> and
<em>redcap_data_access_group</em>, for which we will keep both versions.
We can specify other variables that we do not want to transform to
factor using the argument <code>exclude_to_factor</code> which we will
see later.
</li>
<li>
<u>Transformation of the branching logic:</u> by default, every
branching logic contained in the dictionary is presented in REDCap
logic. In this step, we will convert each branching logic into R logic
in order to apply this information when needed. For example, we will use
it to properly identify missing values in variables with a branching
logic, as we will see later in the vignette.
</li>
</ol>
</div>
<div class="section level5">
<h5 id="data-transformation-and-classification-by-event">
<em>Data transformation and classification by event</em><a class="anchor" aria-label="anchor" href="#data-transformation-and-classification-by-event"></a>
</h5>
<p>Additionally, we can change the final structure of the transformed
dataset. For example, we can split it by each event. This can be done by
specifying in the <code>final_format</code> argument that we want our
data to be split by event.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        final_format <span class="op">=</span> <span class="st">"by_event"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#To print the results</span></span>
<span><span class="va">dataset</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<pre><code>1. Removing selected variables

2. Deleting variables that contain some patterns

3. Recalculating calculated fields and saving them as '[field_name]_recalc'
| Total calculated fields | Non-transcribed fields | Recalculated different fields |
|:-----------------------:|:----------------------:|:-----------------------------:|
|            2            |         0 (0%)         |            1 (50%)            |


|     field_name      | Transcribed? | Is equal? |
|:-------------------:|:------------:|:---------:|
|         age         |     Yes      |   FALSE   |
| screening_fail_crit |     Yes      |   TRUE    |

4. Transforming checkboxes: changing their values to No/Yes and changing their names to the names of its options. For checkboxes that have a branching logic, when the logic is missing their values will be set to missing

Table: Checkbox variables advisable to be reviewed

| Variables without any branching logic |
|:-------------------------------------:|
|        type_underlying_disease        |

5. Replacing original variables for their factor version

6. Converting every branching logic in the dictionary into R logic

7. Final arrangment of the data by event</code></pre>
<p>Now, a final step in the transformation has been added, which
consists in splitting the data according to the events in the study. So,
now the transformed dataset found in the output of the function is a
tibble object with as many data frames as events there are in the REDCap
project:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   events                   vars       df             </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> baseline_visit_arm_1     <span style="color: #949494;">&lt;chr [31]&gt;</span> <span style="color: #949494;">&lt;df [190 × 36]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> follow_up_visit_da_arm_1 <span style="color: #949494;">&lt;chr [4]&gt;</span>  <span style="color: #949494;">&lt;df [152 × 9]&gt;</span></span></span></code></pre></div>
<p>The column <code>df</code> of the nested dataframe is a list
containing the data corresponding to each event. Also the variables of
the forms that are found in each event are reported in the column
<code>vars</code>.</p>
<p>Note: If the REDCap project is longitudinal and the event-form is not
specified, this transformation is not posible.</p>
</div>
<div class="section level5">
<h5 id="data-transformation-and-classification-by-form">
<em>Data transformation and classification by form</em><a class="anchor" aria-label="anchor" href="#data-transformation-and-classification-by-form"></a>
</h5>
<p>Another option is to split the data by the forms found in the REDCap
project. We will use also the <code>final_format</code> argument to
specify that we want to split data by form:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        final_format <span class="op">=</span> <span class="st">"by_form"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#To print the results</span></span>
<span><span class="va">dataset</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<pre><code>1. Removing selected variables

2. Deleting variables that contain some patterns

3. Recalculating calculated fields and saving them as '[field_name]_recalc'
| Total calculated fields | Non-transcribed fields | Recalculated different fields |
|:-----------------------:|:----------------------:|:-----------------------------:|
|            2            |         0 (0%)         |            1 (50%)            |


|     field_name      | Transcribed? | Is equal? |
|:-------------------:|:------------:|:---------:|
|         age         |     Yes      |   FALSE   |
| screening_fail_crit |     Yes      |   TRUE    |

4. Transforming checkboxes: changing their values to No/Yes and changing their names to the names of its options. For checkboxes that have a branching logic, when the logic is missing their values will be set to missing

Table: Checkbox variables advisable to be reviewed

| Variables without any branching logic |
|:-------------------------------------:|
|        type_underlying_disease        |

5. Replacing original variables for their factor version

6. Converting every branching logic in the dictionary into R logic
7. Final arrangment of the data by form</code></pre>
<p>As before, a final step in the transformation has been added, which
is to split the data according to the forms in the study. Thus, the
transformed dataset will now be a tibble object with as many data frames
as forms there are in the REDCap project:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt;   form                        events    vars        df             </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> inclusionexclusion_criteria <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;glue [7]&gt;</span>  <span style="color: #949494;">&lt;df [190 × 11]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> demographics                <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;glue [4]&gt;</span>  <span style="color: #949494;">&lt;df [190 × 9]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> comorbidities               <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;glue [5]&gt;</span>  <span style="color: #949494;">&lt;df [190 × 10]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> cancer                      <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;glue [11]&gt;</span> <span style="color: #949494;">&lt;df [190 × 16]&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> vital_signs                 <span style="color: #949494;">&lt;chr [2]&gt;</span> <span style="color: #949494;">&lt;glue [2]&gt;</span>  <span style="color: #949494;">&lt;df [342 × 7]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> laboratory_findings         <span style="color: #949494;">&lt;chr [2]&gt;</span> <span style="color: #949494;">&lt;glue [2]&gt;</span>  <span style="color: #949494;">&lt;df [342 × 7]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> microbiological_studies     <span style="color: #949494;">&lt;chr [1]&gt;</span> <span style="color: #949494;">&lt;glue [1]&gt;</span>  <span style="color: #949494;">&lt;df [190 × 6]&gt;</span></span></span></code></pre></div>
<p>Note: If the REDCap project is longitudinal and the event-form is not
specified, this transformation is not posible.</p>
</div>
<div class="section level5">
<h5 id="additional-arguments">
<em>Additional arguments</em><a class="anchor" aria-label="anchor" href="#additional-arguments"></a>
</h5>
<p>There are other arguments which can be used to customize some of the
transformation steps that the function performs by default:</p>
<p><br></p>
<p><u>checkbox_labels</u>: specifies the name of the categories for the
checkbox variables. Default is ‘No/Yes’, but we can change it to
‘N/Y’:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        checkbox_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><u>checkbox_na</u>: logical argument involved in the transformation
of checkbox variables. For checkbox variables that have a branching
logic specified, when the logic is missing the values of the checkbox
will be always converted to missing. Additionally, if this argument is
true then also when the branching logic isn’t satisfied their values
will be converted to missing.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        checkbox_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><u>exclude_recalc</u>: specifies the name of the variables that we do
not want to be recalculated. For example, if we do not want to
recalculate the variable <em>age</em>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        exclude_recalc <span class="op">=</span> <span class="st">"age"</span><span class="op">)</span></span></code></pre></div>
<p>This argument is useful to reduce the time of execution of the
function. For calculated fields with complex logic involving variables
in different events the recalculation operation may be time consuming,
so we can prevent the function to recalculate them with this
argument.</p>
<p><br></p>
<p><u>exclude_to_factor</u>: specifies the name of the variables that we
do not want to transform into a factor. For example, if we want the
variable <em>dm</em> to keep its original numeric version:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        exclude_to_factor <span class="op">=</span> <span class="st">"dm"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><u>delete_vars</u>: every variable specified in this argument will be
removed from the dataset. For example, we can change the argument to
remove the date of birth variable from the dataset:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        delete_vars <span class="op">=</span> <span class="st">"d_birth"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><u>delete_pattern</u>: every variable containing the strings
specified in this argument will be removed from the dataset. By default,
the value of <code>delete_pattern</code> is ‘_complete’. For example, we
can change the argument to remove the inclusion and exclusion criteria
variables from the dataset (variables that contain ‘inc_’ and ‘exc_’ in
their names):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        delete_pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"inc_"</span>, <span class="st">"exc_"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><u>which_event</u>: in the transformation by event explained earlier,
we can specify whether we want to keep only one out of all the events in
the dataset. For example, if we only want to keep the baseline
visit:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        final_format <span class="op">=</span> <span class="st">"by_event"</span>,</span>
<span>                        which_event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p><u>which_form</u>: in the transformation by form explained earlier,
we can specify whether we want to keep only one of the forms. For
example, if we only want to keep the demographic form:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        final_format <span class="op">=</span> <span class="st">"by_form"</span>,</span>
<span>                        which_form <span class="op">=</span> <span class="st">"demographics"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="va">data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "record_id"                       "redcap_event_name"              
[3] "redcap_data_access_group"        "redcap_event_name.factor"       
[5] "redcap_data_access_group.factor" "d_admission"                    
[7] "d_birth"                         "age"                            
[9] "age_recalc"                     </code></pre>
<p><br></p>
<p><u>wide</u>: in the transformation by form, we can specify that we
want each of the split datasets to be in a wide format. This is useful
if the form appears in more than one event (or in a repeated event).
Then, we will only have one row per patient and all the variables of the
form will be in columns repeated by each event in the order that the
events appear in REDCap. For example, if we want to keep only the
laboratory findings in a wide format we can do:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                        final_format <span class="op">=</span> <span class="st">"by_form"</span>,</span>
<span>                        which_form <span class="op">=</span> <span class="st">"laboratory_findings"</span>,</span>
<span>                        wide <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataset</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   record_id available_analytics_1 available_analytics_2 potassium_1 potassium_2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 100-6     Yes                   Yes                          4.3          4.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 100-13    Yes                   Yes                          3.66         4.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 100-16    Yes                   No                           4.04        <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 100-31    Yes                   <span style="color: #BB0000;">NA</span>                           4.58        <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 100-34    Yes                   No                           3.48        <span style="color: #BB0000;">NA</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 100-36    Yes                   No                           4.09        <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level4">
<h4 id="rd_rlogic">
<strong>rd_rlogic</strong><a class="anchor" aria-label="anchor" href="#rd_rlogic"></a>
</h4>
<p>This function transforms the REDCap logic into logic that can be
evaluated in R. It returns both the transformed logic and the result of
the evaluation of the logic. This function is used in the
<code><a href="../reference/rd_transform.html">rd_transform()</a></code> to recalculate the calculated fields and
convert the branching logics, but it may also be useful to use it in
other circunstances. Let’s see how it transforms the logic of one of the
calculated fields in the built-in dataset:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">logic_trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_rlogic.html">rd_rlogic</a></span><span class="op">(</span><span class="va">covican</span>,</span>
<span>                         logic <span class="op">=</span> <span class="st">"if([exc_1]='1' or [inc_1]='0' or [inc_2]='0' or [inc_3]='0',1,0)"</span>,</span>
<span>                         var <span class="op">=</span> <span class="st">"screening_fail_crit"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">logic_trans</span><span class="op">)</span></span></code></pre></div>
<pre><code>List of 2
 $ rlogic: chr "ifelse(data$exc_1=='1' | data$inc_1=='0' | data$inc_2=='0' | data$inc_3=='0',1,0)"
 $ eval  : num [1:342] 0 NA 0 NA 0 NA 0 NA 0 NA ...</code></pre>
<p><br></p>
</div>
<div class="section level4">
<h4 id="rd_insert_na">
<strong>rd_insert_na</strong><a class="anchor" aria-label="anchor" href="#rd_insert_na"></a>
</h4>
<p>This function sets some values of a variable to missing if a certain
logic is fulfilled. It can be used as a complementary function for
<code><a href="../reference/rd_transform.html">rd_transform()</a></code>, for example, to change the values of those
checkboxes that do not have a branching logic, as mentioned earlier. For
instance, we can perform a raw transformation of our data, as in section
4.2.1.1, and then use this function to set the values of the checkbox
<em>type_underlying_disease_haematological_cancer</em> to missing when
the age is less than 65 years old:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Raw transformation of the data:</span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_transform.html">rd_transform</a></span><span class="op">(</span><span class="va">covican</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="va">data</span></span>
<span></span>
<span><span class="co">#Before inserting missings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">type_underlying_disease_haematological_cancer</span><span class="op">)</span></span></code></pre></div>
<pre><code>
 No Yes 
103  87 </code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Run the function</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_insert_na.html">rd_insert_na</a></span><span class="op">(</span><span class="va">dataset</span>,</span>
<span>                      event_form <span class="op">=</span> <span class="va">covican</span><span class="op">$</span><span class="va">event_form</span>,</span>
<span>                      vars <span class="op">=</span> <span class="st">"type_underlying_disease_haematological_cancer"</span>,</span>
<span>                      filter <span class="op">=</span> <span class="st">"age &lt; 65"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#After inserting missings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data2</span><span class="op">$</span><span class="va">type_underlying_disease_haematological_cancer</span><span class="op">)</span></span></code></pre></div>
<pre><code>
 No Yes 
 65  50 </code></pre>
<p>Recall that both the variable to be transformed (<em>age</em>) and
the variable included in the filter
(<em>type_underlying_disease_haematological_cancer</em>) are in the same
event. In the contrary, if the variable to be transformed and the filter
didn’t have any event in common then the transformation would give an
error. Furthermore, if the variable to be transformed was in more events
than the filter, only the rows of the events in common would be
converted.</p>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="queries">
<strong>Queries</strong><a class="anchor" aria-label="anchor" href="#queries"></a>
</h3>
<p>Queries are very important to ensure the accuracy and reliability of
a REDCap dataset. The collected data may contain missing values,
inconsistencies, or other potential errors that need to be identified in
order to correct them later.</p>
<p>For all the following examples we will use the raw transformed data:
<code>covican_transformed</code>.</p>
<div class="section level4">
<h4 id="rd_query">
<strong>rd_query</strong><a class="anchor" aria-label="anchor" href="#rd_query"></a>
</h4>
<p>The <code><a href="../reference/rd_query.html">rd_query()</a></code> function allows users to generate queries
by using a specific expression. It can be used to identify missing
values, values that fall outside the lower and upper limit of a variable
and other types of inconsistencies.</p>
<div class="section level5">
<h5 id="output">
<em>Output</em><a class="anchor" aria-label="anchor" href="#output"></a>
</h5>
<p>First, we will examine the output of this function. When the
<code><a href="../reference/rd_query.html">rd_query()</a></code> function is executed, it returns a list that
includes a data frame with all the queries identified and a second
element with a summary of the number of generated queries in each
specified variable for each expression applied:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;">
Identifier
</th>
<th style="text-align:left;font-weight: bold;">
DAG
</th>
<th style="text-align:left;font-weight: bold;">
Event
</th>
<th style="text-align:left;font-weight: bold;">
Instrument
</th>
<th style="text-align:left;font-weight: bold;">
Field
</th>
<th style="text-align:left;font-weight: bold;">
Repetition
</th>
<th style="text-align:left;font-weight: bold;">
Description
</th>
<th style="text-align:left;font-weight: bold;">
Query
</th>
<th style="text-align:left;font-weight: bold;">
Code
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
100-58
</td>
<td style="text-align:left;">
Hospital 11
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
100-58-1
</td>
</tr>
<tr>
<td style="text-align:left;">
105-11
</td>
<td style="text-align:left;">
Hospital 5
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
105-11-1
</td>
</tr>
<tr>
<td style="text-align:left;">
105-56
</td>
<td style="text-align:left;">
Hospital 5
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
105-56-1
</td>
</tr>
<tr>
<td style="text-align:left;">
112-15
</td>
<td style="text-align:left;">
Hospital 10
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
112-15-1
</td>
</tr>
<tr>
<td style="text-align:left;">
117-11
</td>
<td style="text-align:left;">
Hospital 2
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
117-11-1
</td>
</tr>
<tr>
<td style="text-align:left;">
117-22
</td>
<td style="text-align:left;">
Hospital 2
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
117-22-1
</td>
</tr>
</tbody>
</table>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr></tbody>
</table>
<p>The data frame is designed to aid users in locating each query in
their REDCap project. It includes information such as the record
identifier, the Data Access Group (DAG), the event in which each query
can be found, along with the name and the description of the analyzed
variable and a brief description of the query.</p>
<p>Let’s see some examples of the usability of the function in
generating different types of queries.</p>
</div>
<div class="section level5">
<h5 id="missings">
<em>Missings</em><a class="anchor" aria-label="anchor" href="#missings"></a>
</h5>
<p>If we want to identify missing values in the variables <em>copd</em>
and <em>age</em> in the raw transformed data, a list of required
arguments needs to be supplied. We must use the <code>variables</code>
argument to specify the variables from the database that will be
examined and the <code>expression</code> argument to describe the
expression that will be applied to those variables, in this case
‘is.na(x)’ to detect missing values where x represents the variable
itself. Additionaly, we must use the <code>data</code> and
<code>dic</code> arguments to indicate the R objects containing the
REDCap data and dictionary, respectively. If the REDCap project presents
a longitudinal design, we should also specify the event in which the
described variables are present through the use of the
<code>event</code> argument:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"copd"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span>, <span class="st">"is.na(x)"</span><span class="op">)</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
5
</td>
</tr>
</tbody>
</table>
<p>In this case, we can observe that there are 6 missing values in the
<em>copd</em> variable and 5 missing values in <em>age</em>.</p>
</div>
<div class="section level5">
<h5 id="missings-of-variables-with-a-branching-logic">
<em>Missings of variables with a branching logic</em><a class="anchor" aria-label="anchor" href="#missings-of-variables-with-a-branching-logic"></a>
</h5>
<p>Another example is when we try to identify missing values in
variables where a branching logic is employed. In this scenario, when
the conditions of the branching logic are not satisfied, by definition,
all of the values should be missing and thus queries for this specific
missing values (conditions not met) should not be reported. To adress
this, the function, when working with raw data, follows a two-step
process. Firstly, it transforms the branching logic associated with the
specified variable. Then, it applies this transformed logic during the
query generation process. However, if the dataset has already been
transformed using the <code><a href="../reference/rd_transform.html">rd_transform()</a></code> function beforehand,
the function will automatically apply the previously transformed
branching logic.</p>
<p>In both scenarios, if a variable contains branching logic that cannot
be converted from REDCap logic to R logic, the function will issue a
warning. The warning message will advise the user to review the
<code>results</code> element of the output for more information. This is
to indicate that there might be potential issues or limitations with the
conversion process for that specific variable’s branching logic:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"copd"</span>, <span class="st">"potassium"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span>, <span class="st">"is.na(x)"</span>, <span class="st">"is.na(x)"</span><span class="op">)</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: The branching logic of the following variables could not be converted into R logic:
 - potassium
 Check the results element of the output(...$results) for details.</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Branching logic
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
potassium
</td>
<td style="text-align:center;">
Potassium
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
31
</td>
<td style="text-align:center;">
[available_analytics][current-instance]=‘1’
</td>
</tr>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
<ul><li></ul>
</td>
</tr>
</tbody>
</table>
<p>Based on the information provided, in addition to the missing values
of the <em>age</em> and <em>copd</em> variables already identified,
there are 31 missing values in the <em>potassium</em> variable. The
branching logic associated with this variable,
<code>[available_analytics][current-instance]=‘1’</code>, contains a
smart variable <code>[current-instance]</code>, which cannot be directly
transformed into R logic.</p>
<p>To address this issue and correctly identify missing values only when
<em>available_analytics</em> has the value <em>1</em>, the filter
argument can be utilized. By specifying the condition within the
branching logic, you can ensure that the filtering process fulfills this
condition.</p>
<p>It is worth noting that during the transformation process, the value
<em>1</em> of the <em>available_analytics</em> variable was changed to
<em>Yes</em> due to it being a factor. Therefore, when implementing the
filter, you need to consider this transformed value rather than the
original one. This ensures that the condition is accurately applied and
missing values are appropriately identified based on the desired
criteria.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"potassium"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span><span class="op">)</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                    filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"available_analytics=='Yes'"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: The branching logic of the following variables could not be converted into R logic:
 - potassium
 Check the results element of the output(...$results) for details.</code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Branching logic
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
potassium
</td>
<td style="text-align:center;">
Potassium
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
[available_analytics][current-instance]=‘1’
</td>
</tr></tbody>
</table>
<p>The total number of missing values changes when we use the
<code>filter</code> argument, the variable <em>potassium</em> now
presents 21 missing values instead of the previous 31 cases identified.
This means that we were identifying 10 missing values in which
<em>available_analytics</em> did not have the value <em>Yes</em> and,
therefore, should not be considered as missing values.</p>
<p>Note: The <code>filter</code> argument is treated as a vector, which
means that we can add a filter to each specified variable. Also, even if
this argument is used to apply the branching logic condition, the
warning about the presence of unconverted branching logic will still be
displayed. In this specific case, you can safely ignore this
warning.</p>
</div>
<div class="section level5">
<h5 id="expressions">
<em>Expressions</em><a class="anchor" aria-label="anchor" href="#expressions"></a>
</h5>
<p>Up until this point, we have illustrated examples where the
expression applied is used to detect missing values. But, as previously
mentioned, the <code><a href="../reference/rd_query.html">rd_query()</a></code> function is also able to identify
outliers or observations that fulfill a specific condition. Hence, to
identify, for example, all the observations where <em>age</em> is
greater than 70, we should use the <code>expression</code> argument
again specifying ‘x&gt;70’:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span>variables<span class="op">=</span><span class="st">"age"</span>,</span>
<span>                    expression<span class="op">=</span><span class="st">"x&gt;70"</span>,</span>
<span>                    event<span class="op">=</span><span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                    dic<span class="op">=</span><span class="va">covican_transformed</span><span class="op">$</span><span class="va">dictionary</span>,</span>
<span>                    data<span class="op">=</span><span class="va">covican_transformed</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be greater than 70
</td>
<td style="text-align:center;">
76
</td>
</tr></tbody>
</table>
<p><br></p>
<p>We can add other variables with other specific expressions in the
same function because it is designed to treat the arguments
<code>variables</code> and <code>expression</code> as vectors, so that
the element at position <em>n</em> of <code>expression</code> is applied
to the element at position <em>n</em> of <code>variables</code>.</p>
<p>For example, if we want to identify all the observations where
<em>age</em> is greater than 70 and all the observations where
<em>copd</em> is ‘Yes’ we shall use:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"copd"</span><span class="op">)</span>,</span>
<span>                    expression<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x &gt; 70"</span>, <span class="st">"x == 'Yes'"</span><span class="op">)</span>,</span>
<span>                    event<span class="op">=</span><span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be greater than 70
</td>
<td style="text-align:center;">
76
</td>
</tr>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be equal to ‘Yes’
</td>
<td style="text-align:center;">
21
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>In a more complex scenario, for example, to identify all the
observations where <em>age</em> is greater than 70, less than 80, or it
is a missing value we shall use the following expression:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables<span class="op">=</span><span class="st">"age"</span>,</span>
<span>                    expression<span class="op">=</span><span class="st">"(x&gt;70 &amp; x&lt;80) | is.na(x)"</span>,</span>
<span>                    event<span class="op">=</span><span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be (greater than 70 and less than 80) or missing
</td>
<td style="text-align:center;">
54
</td>
</tr></tbody>
</table>
</div>
<div class="section level5">
<h5 id="special-cases">
<em>Special cases</em><a class="anchor" aria-label="anchor" href="#special-cases"></a>
</h5>
<p><u>Same expression for all variables</u></p>
<p>In order to evaluate the same expression for all variables, the user
should supply just a single element for <code>expression</code>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"copd"</span>,<span class="st">"age"</span>,<span class="st">"dm"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="st">"is.na(x)"</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: Due to the greater number of variables compared to expressions, the
same expression has been applied to all of them.</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
5
</td>
</tr>
<tr>
<td style="text-align:center;">
dm
</td>
<td style="text-align:center;">
Diabetes (treated with insulin or antidiabetic …
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
5
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>The function issues a warning every time the same expression is
applied to all variables to ensure that the user did not make a mistake
when providing the information for each argument.</p>
<p><br></p>
<p><u>Not defining an event</u></p>
<p>Another special case is when the data analysed corresponds to a
REDCap longitudinal project, but the event argument of the function is
not defined.</p>
<p>There are two possibilities here:</p>
<ol>
<li>
<u>With event-form:</u> the function automatically detects in which
events the variable is collected and generates queries for those events.
</li>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="st">"copd"</span>,</span>
<span>                    expression <span class="op">=</span> <span class="st">"is.na(x)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr></tbody>
</table>
<p>We get the same result as if we had used the <code>event</code>
argument.</p>
<li>
<u>Without event-form:</u> the function generates queries for all events
present in the dataset.
</li>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">covican_transformed</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">covican_transformed</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"event_form"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">my_list</span>,</span>
<span>                    variables <span class="op">=</span> <span class="st">"copd"</span>,</span>
<span>                    expression <span class="op">=</span> <span class="st">"is.na(x)"</span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: No event or event-form has been specified. Therefore, the function
will automatically consider observations from all events in the dataset. Ensure
that the selected variable(s) is(are) collected in all specified events. This
will avoid overestimating the number of queries.</code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Follow up visit day 14+/-5d
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
152
</td>
</tr>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr>
</tbody>
</table>
<p>As we can see, there are 152 new missing values in the follow-up
visit because the variable <em>copd</em> it is only present in the
baseline visit. Thus, it might result in an overestimation of the number
of missing values, as the function considers all the events of the study
if no event is specified.</p>
<p>The function will issue a warning if it detects that the REDCap
project contains multiple events, the event-form mapping is not
specified and the <code>event</code> argument is not specified.</p>
</ol>
<p><br></p>
</div>
<div class="section level5">
<h5 id="additional-arguments-1">
<em>Additional arguments</em><a class="anchor" aria-label="anchor" href="#additional-arguments-1"></a>
</h5>
<p><u>variable_names, query_name, instrument</u></p>
<p>These arguments allow users to customize the data frame returned by
the function. We can change the variables names using the
<code>variables_names</code> argument, alter the description of the
query using the <code>query_name</code> argument or even change the name
of the instrument using the <code>instrument</code> argument:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                   variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"copd"</span><span class="op">)</span>,</span>
<span>                   variables_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chronic obstructive pulmonary disease (Yes/No)"</span><span class="op">)</span>,</span>
<span>                   expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span><span class="op">)</span>,</span>
<span>                   query_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"COPD is a missing value."</span><span class="op">)</span>,</span>
<span>                   instrument <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Admission"</span><span class="op">)</span>,</span>
<span>                   event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span></code></pre></div>
<p>Output:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;">
Identifier
</th>
<th style="text-align:left;font-weight: bold;">
DAG
</th>
<th style="text-align:left;font-weight: bold;">
Event
</th>
<th style="text-align:left;font-weight: bold;">
Instrument
</th>
<th style="text-align:left;font-weight: bold;">
Field
</th>
<th style="text-align:left;font-weight: bold;">
Repetition
</th>
<th style="text-align:left;font-weight: bold;">
Description
</th>
<th style="text-align:left;font-weight: bold;">
Query
</th>
<th style="text-align:left;font-weight: bold;">
Code
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
100-58
</td>
<td style="text-align:left;">
Hospital 11
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Admission
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease (Yes/No)
</td>
<td style="text-align:left;">
COPD is a missing value.
</td>
<td style="text-align:left;">
100-58-1
</td>
</tr></tbody>
</table>
<p><br></p>
<p><u>negate</u></p>
<p>This argument can be used to negate the expression applied to the
variables. For example, if we want to identify all the non missing
values of the variable <em>copd</em>, we can apply the expression
‘is.na(x)’ which normally would report the missing values and add
<code>negate = TRUE</code>, so the result will be the number of non
missing values in <em>copd</em>:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="st">"copd"</span>,</span>
<span>                    expression <span class="op">=</span> <span class="st">"is.na(x)"</span>,</span>
<span>                    negate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should be missing
</td>
<td style="text-align:center;">
184
</td>
</tr></tbody>
</table>
<p>There are 184 non missing values in the variable <em>copd</em>.</p>
<p><br></p>
<p><u>addTo</u></p>
<p>In order to keep all queries in the same R object, we can use the
<code>addTo</code> argument to specify the output of another query
dataset.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                     variables <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                     expression <span class="op">=</span> <span class="st">"is.na(x)"</span>,</span>
<span>                     event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                     addTo <span class="op">=</span> <span class="va">example</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example2</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should be missing
</td>
<td style="text-align:center;">
184
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
5
</td>
</tr>
</tbody>
</table>
<p>We have joined our former output of 184 non missing values in the
variable <em>copd</em> with the new query dataset composed by the 5
missing values of the variable <em>age</em>.</p>
<p><br></p>
<p><u>report_title</u></p>
<p>To customize the title of the summary of queries, we can use the
<code>report_title</code> argument:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"copd"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span>, <span class="st">"x&lt;20"</span><span class="op">)</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                    report_title <span class="op">=</span> <span class="st">"Missing COPD values in the baseline event"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Missing COPD values in the baseline event
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr></tbody>
</table>
<p>The default title of the summary is “Report of queries” but we have
changed it to “Missing COPD values in the baseline event”.</p>
<p><br></p>
<p><u>report_zeros</u></p>
<p>By default, the function will only report, in the summary of queries,
variables with at least one query and will omit those with zero queries.
To include these omitted variables in the summary, we can use the
<code>report_zeros</code> argument:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"copd"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span>, <span class="st">"x &lt; 20"</span><span class="op">)</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                    report_zeros <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
6
</td>
</tr>
<tr>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be less than 20
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p>The variable <em>age</em> is reported in the summary in spite of not
having any queries identified.</p>
<p><br></p>
<p><u>by_dag</u></p>
<p>If the REDCap project has Data Access Groups (DAGs), it might be of
our interest to report the summary by each one of the DAGs. To do that,
we can use the <code>by_dag</code> argument:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"copd"</span>, <span class="st">"age"</span><span class="op">)</span>,</span>
<span>                    expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is.na(x)"</span>, <span class="st">"x&gt;60"</span><span class="op">)</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                    by_dag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now we can choose to see the report of a specific DAG, for example,
the summary of the generated queries for the <em>Hospital 2</em>:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">`Hospital 2`</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
DAG
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Variables
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Event
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Query
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Hospital 2
</td>
<td style="text-align:center;">
age
</td>
<td style="text-align:center;">
Age
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be greater than 60
</td>
<td style="text-align:center;">
3
</td>
</tr>
<tr>
<td style="text-align:center;">
Hospital 2
</td>
<td style="text-align:center;">
copd
</td>
<td style="text-align:center;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
The value should not be missing
</td>
<td style="text-align:center;">
2
</td>
</tr>
</tbody>
</table>
<p>For this DAG, there are 3 values of <em>age</em> bigger than 60 and 2
missing values in the variable <em>copd</em>.</p>
<p><br></p>
<p><u>link</u></p>
<p>There is an easier way to have access to each query in REDCap through
the output of the function. By using the <code>link</code> argument to
specify the domain, the REDCap version, the project ID and the event ID,
the function will add a column in the <em>$queries</em> element of the
output with the direct link to REDCap where the query can be found.</p>
<p>Note: The link will only work if the user has access to the project
and has at least data viewing rights.</p>
<p>We can find the information about the domain, the REDCap version and
the project ID in the link of the <em>Project Home</em> of the project
in REDCap:</p>
<p><img src="files/ProjectHome.png"><!-- --></p>
<p>The identifiers of the events can be exported from: <em>Project
Setup</em> &lt; <em>Define My Events</em></p>
<p><img src="files/EventsID.png"><!-- --></p>
<p>Once we have this information, we pass it as a list to the
<code>link</code> argument:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_query.html">rd_query</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    variables <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>                    expression <span class="op">=</span> <span class="st">"x&gt;89"</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"baseline_visit_arm_1"</span>,</span>
<span>                    link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>domain <span class="op">=</span> <span class="st">"redcappre.idibell.cat"</span>,</span>
<span>                                redcap_version <span class="op">=</span> <span class="st">"13.1.9"</span>,</span>
<span>                                proj_id <span class="op">=</span> <span class="fl">800</span>,</span>
<span>                                event_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"baseline_visit_arm_1"</span> <span class="op">=</span> <span class="fl">811</span>, <span class="st">"follow_up_visit_da_arm_1"</span> <span class="op">=</span> <span class="fl">812</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The output of the function now has an additional column with the link
to the respective query:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Printing results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">queries</span><span class="op">$</span><span class="va">Link</span></span></code></pre></div>
<pre><code>[1] "https://redcappre.idibell.cat/redcap_v13.1.9/DataEntry/index.php?pid=800&amp;event_id=811&amp;page=demographics&amp;id=109-22"
[2] "https://redcappre.idibell.cat/redcap_v13.1.9/DataEntry/index.php?pid=800&amp;event_id=811&amp;page=demographics&amp;id=110-19"</code></pre>
<p>We can go straight to the specific query by copying and pasting the
link into the web browser of your choice.</p>
</div>
</div>
<div class="section level4">
<h4 id="rd_event">
<strong>rd_event</strong><a class="anchor" aria-label="anchor" href="#rd_event"></a>
</h4>
<p>When working with a longitudinal REDCap project (presence of events),
the exported data has a structure where each row represents one event
per record. However, by default, REDCap will not export the
corresponding rows of the events that have no collected data. So, if we
try to identify missing values in variables that are inside a missing
event for some records using the <code><a href="../reference/rd_query.html">rd_query()</a></code> function, these
missing values will not be identified because they do not exist in the
exported data. The <code><a href="../reference/rd_event.html">rd_event()</a></code> function can be used to point
out in how many records an event does not exist:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_event.html">rd_event</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"follow_up_visit_da_arm_1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Events
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
follow_up_visit_da_arm_1
</td>
<td style="text-align:center;">
Follow up visit day 14+/-5d
</td>
<td style="text-align:center;">
38
</td>
</tr></tbody>
</table>
<p>There are a total of 38 events per record without any row
corresponding to the event <em>Follow up visit day 14+/-5d</em>. Thus,
when searching for missing values of variables in the <em>Follow up
visit day 14+/-5d</em> event, we need to consider that there will be 38
additional missing values which will not be accounted for by
<code><a href="../reference/rd_query.html">rd_query()</a></code>.</p>
<p><br></p>
<p>It might happen that an event is not mandatory for all records so we
only want to check if the event is missing in a subgroup of records. For
example, in the <em>COVICAN</em> study only patients satisfying the
inclusion and exclusion criteria would have to perform the follow up
visit. Therefore, to check if the follow up event is missing only in the
records that fulfill the inclusion and exclusion criteria, we can use
the <code>filter</code> argument of the <code><a href="../reference/rd_event.html">rd_event()</a></code>
function:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_event.html">rd_event</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    event <span class="op">=</span> <span class="st">"follow_up_visit_da_arm_1"</span>,</span>
<span>                    filter <span class="op">=</span> <span class="st">"screening_fail_crit==0"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Events
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:center;">
follow_up_visit_da_arm_1
</td>
<td style="text-align:center;">
Follow up visit day 14+/-5d
</td>
<td style="text-align:center;">
34
</td>
</tr></tbody>
</table>
<p><br></p>
<p>Like the <code><a href="../reference/rd_query.html">rd_query()</a></code> function, this function also treats
the argument <code>event</code> as a vector allowing us to check for
multiple missing events at the same time.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rd_event.html">rd_event</a></span><span class="op">(</span><span class="va">covican_transformed</span>,</span>
<span>                    event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"baseline_visit_arm_1"</span>,<span class="st">"follow_up_visit_da_arm_1"</span><span class="op">)</span>,</span>
<span>                    filter <span class="op">=</span> <span class="st">"screening_fail_crit==0"</span>,</span>
<span>                    report_zeros <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="va">example</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Report of queries
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
Events
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Description
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
follow_up_visit_da_arm_1
</td>
<td style="text-align:center;">
Follow up visit day 14+/-5d
</td>
<td style="text-align:center;">
34
</td>
</tr>
<tr>
<td style="text-align:center;">
baseline_visit_arm_1
</td>
<td style="text-align:center;">
Baseline visit
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Note: This function also has the arguments <code>query_name</code>,
<code>addTo</code>, <code>report_title</code>, <code>report_zeros</code>
and <code>link</code> that work in the same way as in the examples
previously mentioned in section 4.3.1.6.</p>
</div>
<div class="section level4">
<h4 id="check_queries">
<strong>check_queries</strong><a class="anchor" aria-label="anchor" href="#check_queries"></a>
</h4>
<p>Once the process of identifying queries is complete, the typical
approach would be to adress them by modifying the original dataset in
REDCap and re-run the query identification process generating a new
query dataset.</p>
<p>The <code><a href="../reference/check_queries.html">check_queries()</a></code> function compares the previous query
dataset with the new one by using the arguments <code>old</code> and
<code>new</code>, respectively. The output remains a list with 2 items,
but the data frame containing the information for each query will now
have an additional column (“Modification”) indicating which queries are
new, which have been modified, which have been corrected, and which
remain unchanged. Besides, the summary will show the number of queries
in each one of these categories:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_queries.html">check_queries</a></span><span class="op">(</span>old <span class="op">=</span> <span class="va">example</span><span class="op">$</span><span class="va">queries</span>, </span>
<span>                       new <span class="op">=</span> <span class="va">new_example</span><span class="op">$</span><span class="va">queries</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print results</span></span>
<span><span class="va">check</span><span class="op">$</span><span class="va">results</span></span></code></pre></div>
<table class="table table table-striped table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Comparison report
</caption>
<thead><tr>
<th style="text-align:center;border-bottom: 1px solid grey">
State
</th>
<th style="text-align:center;border-bottom: 1px solid grey">
Total
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
Pending
</td>
<td style="text-align:center;">
7
</td>
</tr>
<tr>
<td style="text-align:center;">
Solved
</td>
<td style="text-align:center;">
4
</td>
</tr>
<tr>
<td style="text-align:center;">
Miscorrected
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
New
</td>
<td style="text-align:center;">
1
</td>
</tr>
</tbody>
</table>
<p>There are 7 queries pending resolution, 4 solved queries, 1
miscorrected query, and 1 new query between the previous and the new
query dataset.</p>
<p>Note: The “Miscorrected” category includes queries that belong to the
same combination of record identifier and variable in both the old and
new reports, but with a different reason. For instance, if a variable
had a missing value in the old report, but in the new report shows a
value outside the established range, it would be classified as
“Miscorrected”.</p>
<p><br></p>
<p>Query control output:</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;font-weight: bold;">
Identifier
</th>
<th style="text-align:left;font-weight: bold;">
DAG
</th>
<th style="text-align:left;font-weight: bold;">
Event
</th>
<th style="text-align:left;font-weight: bold;">
Instrument
</th>
<th style="text-align:left;font-weight: bold;">
Field
</th>
<th style="text-align:left;font-weight: bold;">
Repetition
</th>
<th style="text-align:left;font-weight: bold;">
Description
</th>
<th style="text-align:left;font-weight: bold;">
Query
</th>
<th style="text-align:left;font-weight: bold;">
Code
</th>
<th style="text-align:left;font-weight: bold;">
Modification
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
100-58
</td>
<td style="text-align:left;">
Hospital 11
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
100-58-1
</td>
<td style="text-align:left;">
Pending
</td>
</tr>
<tr>
<td style="text-align:left;">
100-79
</td>
<td style="text-align:left;">
Hospital 11
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
100-79-1
</td>
<td style="text-align:left;">
New
</td>
</tr>
<tr>
<td style="text-align:left;">
102-113
</td>
<td style="text-align:left;">
Hospital 24
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Demographics
</td>
<td style="text-align:left;">
age
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Age
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
102-113-1
</td>
<td style="text-align:left;">
Pending
</td>
</tr>
<tr>
<td style="text-align:left;">
105-11
</td>
<td style="text-align:left;">
Hospital 5
</td>
<td style="text-align:left;">
Baseline visit
</td>
<td style="text-align:left;">
Comorbidities
</td>
<td style="text-align:left;">
copd
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
Chronic obstructive pulmonary disease
</td>
<td style="text-align:left;">
The value is NA and it should not be missing
</td>
<td style="text-align:left;">
105-11-1
</td>
<td style="text-align:left;">
Pending
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="rd_export">
<strong>rd_export</strong><a class="anchor" aria-label="anchor" href="#rd_export"></a>
</h4>
<p>With the help of the <code><a href="../reference/rd_export.html">rd_export()</a></code> function, we can export
the identified queries to a <code>.xlsx</code> file of our choice:</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rd_export.html">rd_export</a></span><span class="op">(</span><span class="va">example</span><span class="op">)</span></span></code></pre></div>
<p>This is the easiest way to use the function and it will create a file
with the name “example.xlsx” in your current working directory.</p>
<p>In order to have a more personalised output file, we can add
information to the following arguments:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rd_export.html">rd_export</a></span><span class="op">(</span>queries <span class="op">=</span> <span class="va">example</span><span class="op">$</span><span class="va">queries</span>,</span>
<span>          column <span class="op">=</span> <span class="st">"Link"</span>,</span>
<span>          sheet_name <span class="op">=</span> <span class="st">"Queries - Proyecto"</span>,</span>
<span>          path <span class="op">=</span> <span class="st">"C:/User/Desktop/queries.xlsx"</span>,</span>
<span>          password <span class="op">=</span> <span class="st">"123"</span><span class="op">)</span> </span></code></pre></div>
<p>We specify the sheet name with the <code>sheet_name</code> argument
and the path to the file to be exported with the <code>path</code>
argument. To prevent anyone from modifying the exported file, we can
also add a password.</p>
<p>The <code>column</code> argument refers to the column of the report
that contains the link to each query. The function converts this column
into hyperlink format in the exported file, so that we can simply click
on the link to go to the specific query in the REDCap project.</p>
<p>In both cases, a message will be generated in the console informing
you that the file has been created and where it is located.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by João Carmezim, Pau Satorra, Judith Peñafiel, Esther García, Natàlia Pallarès, Cristian Tebé.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
